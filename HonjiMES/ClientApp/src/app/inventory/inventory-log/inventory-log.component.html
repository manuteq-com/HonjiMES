<div class="headerblock">
    <div class="headerfont font1">庫存管理</div>
    <div class="triangle"></div>
    <div class="lefttriangle">
        <div class="lefttriangle1"></div>
        <div class="lefttriangle2"></div>
    </div>
    <div class="headerfont font2">庫存變動紀錄</div>
    <div class="buttongroup">
        <!-- <dx-button
            class="insertbtn"
            stylingMode="contained"
            text="新增調整單"
            type="success"
            [width]="120"
            (onClick)="creatdata()">
        </dx-button> -->
    </div>
</div>
<div id="form-container">
    <div class="col-auto-12 mt-2 mb-1 ml-4">
        <form action="">
            <dx-form id="form" [formData]="formData" [colCount]="5">
                <dxi-item dataField="Message" [editorOptions]="selectAdjustType" editorType="dxSelectBox">
                    <dxo-label text="種類查詢"></dxo-label>
                </dxi-item>
            </dx-form>
        </form>
    </div>
</div>

<dx-data-grid
    [dataSource]="dataSourceDB"
    showBorders="true"
    keyExpr="id"
    [focusedRowEnabled]="true"
    (onDataErrorOccurred)="onDataErrorOccurred($event)"
    [(autoNavigateToFocusedRow)]="autoNavigateToFocusedRow"
    (onFocusedRowChanging)="onFocusedRowChanging($event)"
    (onFocusedRowChanged)="onFocusedRowChanged($event)"
    (onEditorPreparing)="onEditorPreparing($event)"
    (onSelectionChanged)="selectionChanged($event)"
    hoverStateEnabled="true"
    [rowAlternationEnabled]="true"
    [remoteOperations]="remoteOperations"  [columnAutoWidth]="true">

    <dxo-scrolling columnRenderingMode="virtual"></dxo-scrolling>
    <dxo-selection mode="single"></dxo-selection>
    <dxo-filter-row [visible]="true"></dxo-filter-row>
    <dxo-header-filter [visible]="false"></dxo-header-filter>
    <dxo-sorting mode="multiple"></dxo-sorting>
    <dxo-grouping [autoExpandAll]="true"></dxo-grouping>
    <dxo-paging [pageSize]="20"></dxo-paging>
    <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5, 10, 15, 20, 100]" [showInfo]="true">
    </dxo-pager>
    <dxo-editing mode="row"  [allowAdding]="false" [allowUpdating]="false" [allowDeleting]="false">
        <dxo-form>
            <dxi-item  dataField="AdjustNo"></dxi-item>
            <dxi-item  dataField="LinkOrder"></dxi-item>
            <dxi-item  dataField="DataId"></dxi-item>
            <dxi-item  dataField="Original"></dxi-item>
            <dxi-item  dataField="Quantity"></dxi-item>
            <dxi-item  dataField="Price"></dxi-item>
            <dxi-item  dataField="PriceAll"></dxi-item>
            <dxi-item  dataField="Unit"></dxi-item>
            <dxi-item  dataField="UnitCount"></dxi-item>
            <dxi-item  dataField="UnitPrice"></dxi-item>
            <dxi-item  dataField="UnitPriceAll"></dxi-item>
            <dxi-item  dataField="WorkPrice"></dxi-item>
            <dxi-item  dataField="Reason"></dxi-item>
            <dxi-item  dataField="Message"></dxi-item>
            <dxi-item  dataField="CreateTime"></dxi-item>
            <dxi-item  dataField="CreateUser"></dxi-item>
            <dxi-item  dataField="NameLog"></dxi-item>
            <dxi-item  dataField="NameType"></dxi-item>
        </dxo-form>
        <dxo-popup>
            <dxi-toolbar-item toolbar="bottom" location="after" widget="dxButton" [options]="{ type: 'success', text: '存檔', onClick: saveClickHandler }">
            </dxi-toolbar-item>
            <dxi-toolbar-item toolbar="bottom" location="after" widget="dxButton" [options]="{ type:'danger', text: '取消', onClick: cancelClickHandler }">
            </dxi-toolbar-item>
        </dxo-popup>
    </dxo-editing>


    <dxi-column dataField="CreateTime" caption="建立日期" dataType="date" format="shortDateShortTime" [width]="170" sortOrder="desc"></dxi-column>
    <dxi-column dataField="Message" caption="種類" [width]="140"></dxi-column>
    <dxi-column dataField="AdjustNo" caption="調整單號" [width]="120"></dxi-column>
    <dxi-column dataField="LinkOrder" caption="關聯單號" [width]="130"></dxi-column>

    <dxi-column dataField="DataNo" caption="料號" [width]="220"></dxi-column>
    <dxi-column dataField="DataName" caption="名稱" [width]="220"></dxi-column>
    <dxi-column dataField="WarehouseId" caption="倉別" [width]="120">
        <dxo-lookup [dataSource]="WarehouseList" displayExpr="Name" valueExpr="Id"></dxo-lookup>
    </dxi-column>
    <!-- <dxi-column dataField="DataId" caption="料號" [width]="220">
        <dxo-lookup [dataSource]="MaterialList" displayExpr="MaterialNo" valueExpr="Id"></dxo-lookup>
    </dxi-column>
    <dxi-column dataField="DataId" caption="名稱" [width]="220">
        <dxo-lookup [dataSource]="MaterialList" displayExpr="Name" valueExpr="Id"></dxo-lookup>
    </dxi-column> -->

    <dxi-column dataField="NameType" caption="類別" [width]="100" alignment="center">
        <dxo-lookup [dataSource]="listAdjustStatus" displayExpr="Name" valueExpr="Id"></dxo-lookup>
    </dxi-column>
    <dxi-column dataField="Original" caption="原始數量" [width]="80"></dxi-column>
    <dxi-column dataField="Quantity" caption="增減數量" [width]="80"></dxi-column>
    <dxi-column dataField="Price" caption="單價" format="$ #,##0.##;($ #,##0.##)" [width]="80"></dxi-column>
    <dxi-column dataField="PriceAll" caption="總金額" format="$ #,##0.##;($ #,##0.##)" [width]="80"></dxi-column>
    <dxi-column dataField="UnitCount" caption="計價數量" [width]="80"></dxi-column>
    <dxi-column dataField="Unit" caption="單位" [width]="80"></dxi-column>
    <dxi-column dataField="UnitPrice" caption="單位金額" format="$ #,##0.##;($ #,##0.##)" [width]="80"></dxi-column>
    <dxi-column dataField="UnitPriceAll" caption="計價總額" format="$ #,##0.##;($ #,##0.##)" [width]="80"></dxi-column>
    <dxi-column dataField="WorkPrice" caption="加工費用" format="$ #,##0.##;($ #,##0.##)" [width]="80"></dxi-column>
    <dxi-column dataField="Reason" caption="修改原因" [width]="160"></dxi-column>
    <dxi-column dataField="CreateUser" caption="使用者"></dxi-column>
</dx-data-grid>


